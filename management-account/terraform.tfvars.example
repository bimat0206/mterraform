# -----------------------------------------------------------------------------
# General Configuration
# -----------------------------------------------------------------------------
aws_region  = "us-east-1"
org_prefix  = "myorg"
environment = "management"
workload    = "org"

tags = {
  Project    = "AWS Landing Zone"
  CostCenter = "IT"
  ManagedBy  = "Terraform"
}

# -----------------------------------------------------------------------------
# IAM Identity Center Configuration
# -----------------------------------------------------------------------------
# Enable IAM Identity Center management
# identity_center_enabled = true

# For Internal Identity Store (no external IdP)
# create_identity_store_users  = true
# create_identity_store_groups = true

# For External Identity Provider (Azure AD, Okta, etc.)
# external_idp_enabled         = true
# create_identity_store_users  = false
# create_identity_store_groups = false

# -----------------------------------------------------------------------------
# Example 1: Internal Identity Store with Users and Groups
# -----------------------------------------------------------------------------
# identity_center_enabled = true
# create_identity_store_users = true
# create_identity_store_groups = true
#
# identity_center_groups = {
#   administrators = {
#     display_name = "Administrators"
#     description  = "Full administrative access to all accounts"
#   }
#   developers = {
#     display_name = "Developers"
#     description  = "Developer access to development and staging accounts"
#   }
#   data_engineers = {
#     display_name = "Data Engineers"
#     description  = "Data engineering team"
#   }
#   readonly = {
#     display_name = "ReadOnly"
#     description  = "Read-only access across all accounts"
#   }
#   billing = {
#     display_name = "Billing"
#     description  = "Billing and cost management access"
#   }
# }
#
# identity_center_users = {
#   john_admin = {
#     user_name    = "john.admin"
#     display_name = "John Admin"
#     email        = "john.admin@example.com"
#     first_name   = "John"
#     last_name    = "Admin"
#     group_memberships = ["administrators"]
#   }
#   jane_dev = {
#     user_name    = "jane.developer"
#     display_name = "Jane Developer"
#     email        = "jane.developer@example.com"
#     first_name   = "Jane"
#     last_name    = "Developer"
#     group_memberships = ["developers"]
#   }
#   bob_data = {
#     user_name    = "bob.data"
#     display_name = "Bob Data"
#     email        = "bob.data@example.com"
#     first_name   = "Bob"
#     last_name    = "Data"
#     group_memberships = ["data_engineers"]
#   }
# }
#
# identity_center_permission_sets = {
#   AdministratorAccess = {
#     description      = "Full administrative access"
#     session_duration = "PT8H"
#     aws_managed_policies = ["AdministratorAccess"]
#     tags = {
#       Compliance = "High-Risk"
#     }
#   }
#   PowerUserAccess = {
#     description      = "Power user access (no IAM)"
#     session_duration = "PT4H"
#     aws_managed_policies = ["PowerUserAccess"]
#   }
#   DeveloperAccess = {
#     description      = "Developer access with deployment permissions"
#     session_duration = "PT8H"
#     aws_managed_policies = ["PowerUserAccess"]
#     inline_policy = jsonencode({
#       Version = "2012-10-17"
#       Statement = [
#         {
#           Effect = "Allow"
#           Action = [
#             "eks:DescribeCluster",
#             "eks:ListClusters",
#             "eks:AccessKubernetesApi"
#           ]
#           Resource = "*"
#         }
#       ]
#     })
#   }
#   DataEngineerAccess = {
#     description      = "Data engineering access"
#     session_duration = "PT8H"
#     aws_managed_policies = [
#       "AmazonAthenaFullAccess",
#       "AWSGlueConsoleFullAccess",
#       "AmazonS3FullAccess",
#       "AmazonRedshiftFullAccess"
#     ]
#   }
#   ReadOnlyAccess = {
#     description      = "Read-only access"
#     session_duration = "PT2H"
#     aws_managed_policies = ["ReadOnlyAccess"]
#   }
#   BillingAccess = {
#     description      = "Billing and cost management"
#     session_duration = "PT4H"
#     aws_managed_policies = ["job-function/Billing"]
#   }
# }
#
# identity_center_account_assignments = {
#   # Management Account
#   "admins-management" = {
#     account_id       = "111111111111"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
#   "billing-management" = {
#     account_id       = "111111111111"
#     permission_set   = "BillingAccess"
#     principal_type   = "GROUP"
#     principal_name   = "billing"
#   }
#
#   # Network Account
#   "admins-network" = {
#     account_id       = "222222222222"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
#   "readonly-network" = {
#     account_id       = "222222222222"
#     permission_set   = "ReadOnlyAccess"
#     principal_type   = "GROUP"
#     principal_name   = "readonly"
#   }
#
#   # Development Workload Account
#   "admins-dev" = {
#     account_id       = "333333333333"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
#   "devs-dev" = {
#     account_id       = "333333333333"
#     permission_set   = "DeveloperAccess"
#     principal_type   = "GROUP"
#     principal_name   = "developers"
#   }
#   "readonly-dev" = {
#     account_id       = "333333333333"
#     permission_set   = "ReadOnlyAccess"
#     principal_type   = "GROUP"
#     principal_name   = "readonly"
#   }
#
#   # Production Workload Account
#   "admins-prod" = {
#     account_id       = "444444444444"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
#   "readonly-prod" = {
#     account_id       = "444444444444"
#     permission_set   = "ReadOnlyAccess"
#     principal_type   = "GROUP"
#     principal_name   = "readonly"
#   }
#
#   # Data Account
#   "data-engineers-data" = {
#     account_id       = "555555555555"
#     permission_set   = "DataEngineerAccess"
#     principal_type   = "GROUP"
#     principal_name   = "data_engineers"
#   }
# }

# -----------------------------------------------------------------------------
# Example 2: External Identity Provider (Azure AD)
# -----------------------------------------------------------------------------
# identity_center_enabled = true
# external_idp_enabled = true
# create_identity_store_users = false
# create_identity_store_groups = false
#
# # Reference external Azure AD groups
# external_groups = {
#   administrators = {
#     display_name = "AWS-Administrators"  # Must match Azure AD group name
#   }
#   developers = {
#     display_name = "AWS-Developers"
#   }
#   data_engineers = {
#     display_name = "AWS-DataEngineers"
#   }
#   readonly = {
#     display_name = "AWS-ReadOnly"
#   }
# }
#
# # Permission sets (same as above)
# identity_center_permission_sets = {
#   AdministratorAccess = {
#     description      = "Full administrative access"
#     session_duration = "PT8H"
#     aws_managed_policies = ["AdministratorAccess"]
#   }
#   # ... other permission sets ...
# }
#
# # Account assignments using external groups
# identity_center_account_assignments = {
#   "admins-all-accounts" = {
#     account_id       = "111111111111"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
#   # ... other assignments ...
# }

# -----------------------------------------------------------------------------
# Example 3: Minimal Setup
# -----------------------------------------------------------------------------
# identity_center_enabled = true
# create_identity_store_users = true
# create_identity_store_groups = true
#
# identity_center_groups = {
#   administrators = {
#     display_name = "Administrators"
#     description  = "Administrators group"
#   }
# }
#
# identity_center_users = {
#   admin = {
#     user_name    = "admin"
#     display_name = "Administrator"
#     email        = "admin@example.com"
#     first_name   = "Admin"
#     last_name    = "User"
#     group_memberships = ["administrators"]
#   }
# }
#
# identity_center_permission_sets = {
#   AdministratorAccess = {
#     description      = "Full admin access"
#     session_duration = "PT8H"
#     aws_managed_policies = ["AdministratorAccess"]
#   }
# }
#
# identity_center_account_assignments = {
#   "admin-management" = {
#     account_id       = "111111111111"
#     permission_set   = "AdministratorAccess"
#     principal_type   = "GROUP"
#     principal_name   = "administrators"
#   }
# }

# -----------------------------------------------------------------------------
# Common Permission Set Examples
# -----------------------------------------------------------------------------
# Full Access:
# - AdministratorAccess: Full access to everything
# - PowerUserAccess: Full access except IAM
#
# Service-Specific:
# - ViewOnlyAccess: Console read-only
# - ReadOnlyAccess: API read-only
# - SecurityAudit: Security audit access
#
# Job Functions:
# - job-function/Billing: Billing access
# - job-function/DataScientist: Data science tools
# - job-function/DatabaseAdministrator: Database admin
# - job-function/NetworkAdministrator: Network admin
# - job-function/SystemAdministrator: System admin
#
# Service-Specific Examples:
# - AmazonS3FullAccess: S3 full access
# - AmazonEC2FullAccess: EC2 full access
# - AWSLambda_FullAccess: Lambda full access
# - AmazonRDSFullAccess: RDS full access

# -----------------------------------------------------------------------------
# Session Duration Guidelines
# -----------------------------------------------------------------------------
# PT1H  - 1 hour (default, use for privileged operations)
# PT2H  - 2 hours (read-only users)
# PT4H  - 4 hours (standard developers)
# PT8H  - 8 hours (full-time developers/admins)
# PT12H - 12 hours (maximum, for extended work sessions)

# -----------------------------------------------------------------------------
# Account IDs Reference
# -----------------------------------------------------------------------------
# Replace these with your actual AWS account IDs:
# - Management Account: 111111111111
# - Network Account: 222222222222
# - Dev Workload Account: 333333333333
# - Prod Workload Account: 444444444444
# - Data Account: 555555555555

# After deployment:
# 1. Users will receive email invitation to set up password
# 2. Access AWS SSO portal URL (find in AWS Console -> IAM Identity Center)
# 3. Users login with email and password
# 4. Users select account and role from portal
# 5. Users can also use AWS CLI with: aws sso login --profile <profile-name>

# For AWS CLI configuration, users should run:
# aws configure sso
# SSO start URL: <your-sso-portal-url>
# SSO region: us-east-1
# SSO account ID: <account-id>
# SSO role name: <permission-set-name>

# -----------------------------------------------------------------------------
# IAM Identity Center Cost
# -----------------------------------------------------------------------------
# IAM Identity Center is FREE
# - No charge for users, groups, permission sets
# - No charge for account assignments
# - External IdP may have separate costs (Azure AD, Okta, etc.)
# - You only pay for AWS resources accessed by users

# =============================================================================
# AWS Config Configuration
# =============================================================================
config_enabled = false  # Set to true to enable AWS Config

# # Config Settings
# config_enable_recorder             = true
# config_include_global_resources    = true  # Only true in one region
# config_recording_frequency         = "CONTINUOUS"
#
# # Organization Aggregator
# config_enable_organization_aggregator = true
# config_aggregator_regions             = []  # Empty = all regions
#
# # SNS Notifications
# config_sns_email_subscriptions = [
#   "security@example.com",
#   "compliance@example.com"
# ]
#
# # Example Config Rules
# config_managed_rules = {
#   encrypted-volumes = {
#     description = "Check if EBS volumes are encrypted"
#     identifier  = "ENCRYPTED_VOLUMES"
#   }
#   iam-password-policy = {
#     description = "Ensure IAM password policy meets requirements"
#     identifier  = "IAM_PASSWORD_POLICY"
#     input_parameters = {
#       RequireUppercaseCharacters = "true"
#       RequireLowercaseCharacters = "true"
#       RequireNumbers             = "true"
#       RequireSymbols             = "true"
#       MinimumPasswordLength      = "14"
#       MaxPasswordAge             = "90"
#     }
#   }
#   s3-bucket-public-read-prohibited = {
#     description = "Check if S3 buckets prohibit public read"
#     identifier  = "S3_BUCKET_PUBLIC_READ_PROHIBITED"
#   }
#   s3-bucket-public-write-prohibited = {
#     description = "Check if S3 buckets prohibit public write"
#     identifier  = "S3_BUCKET_PUBLIC_WRITE_PROHIBITED"
#   }
#   root-account-mfa-enabled = {
#     description = "Check if root account has MFA enabled"
#     identifier  = "ROOT_ACCOUNT_MFA_ENABLED"
#   }
# }

# =============================================================================
# AWS GuardDuty Configuration
# =============================================================================
guardduty_enabled = false  # Set to true to enable GuardDuty

# # GuardDuty Settings
# guardduty_finding_frequency = "FIFTEEN_MINUTES"  # FIFTEEN_MINUTES, ONE_HOUR, or SIX_HOURS
#
# # Protection Features (all enabled by default)
# guardduty_enable_s3_protection       = true
# guardduty_enable_eks_protection      = true
# guardduty_enable_malware_protection  = true
# guardduty_enable_rds_protection      = true
# guardduty_enable_lambda_protection   = true
#
# # Organization Configuration
# guardduty_enable_organization_admin = true
# guardduty_auto_enable_members       = true  # Auto-enable for new accounts
#
# # SNS Notifications (medium and high severity findings)
# guardduty_sns_email_subscriptions = [
#   "security@example.com",
#   "soc@example.com"
# ]
# 
# # Severity Filter (4.0-8.9 = medium to high)
# # Low: 1-3.9, Medium: 4-6.9, High: 7-8.9
# # Default: only medium and high severity findings
# guardduty_severity_filter = [4, 4.0, 4.1, 4.2, 4.3, 4.4, 4.5, 4.6, 4.7, 4.8, 4.9, 5, 5.0, 5.1, 5.2, 5.3, 5.4, 5.5, 5.6, 5.7, 5.8, 5.9, 6, 6.0, 6.1, 6.2, 6.3, 6.4, 6.5, 6.6, 6.7, 6.8, 6.9, 7, 7.0, 7.1, 7.2, 7.3, 7.4, 7.5, 7.6, 7.7, 7.8, 7.9, 8, 8.0, 8.1, 8.2, 8.3, 8.4, 8.5, 8.6, 8.7, 8.8, 8.9]

# =============================================================================
# AWS Security Hub Configuration
# =============================================================================
securityhub_enabled = false  # Set to true to enable Security Hub

# # Security Hub Settings
# securityhub_control_finding_generator = "SECURITY_CONTROL"  # or "STANDARD_CONTROL"
#
# # Organization Configuration
# securityhub_enable_organization_admin = true
# securityhub_auto_enable_members       = true  # Auto-enable for new accounts
# securityhub_auto_enable_standards     = true  # Auto-enable standards for new accounts
#
# # Security Standards (CIS and AWS Foundational enabled by default)
# securityhub_enable_cis_standard            = true
# securityhub_cis_version                    = "1.4.0"  # 1.2.0 or 1.4.0
# securityhub_enable_aws_foundational_standard = true
# securityhub_aws_foundational_version       = "1.0.0"
# securityhub_enable_pci_dss_standard        = false  # Enable if handling credit card data
# securityhub_enable_nist_standard           = false  # Enable for federal compliance
#
# # Product Integrations (auto-detects available products)
# securityhub_enable_product_integrations = true
#
# # Finding Aggregator (consolidate findings from all regions)
# securityhub_enable_finding_aggregator  = true
# securityhub_aggregator_linking_mode    = "ALL_REGIONS"  # or "SPECIFIED_REGIONS"
#
# # SNS Notifications (critical, high, and medium findings)
# securityhub_sns_email_subscriptions = [
#   "security@example.com",
#   "compliance@example.com"
# ]
# securityhub_severity_filter       = ["CRITICAL", "HIGH", "MEDIUM"]
# securityhub_workflow_status_filter = ["NEW", "NOTIFIED"]

# =============================================================================
# Security Services Notes
# =============================================================================
# 
# AWS Config:
# - Tracks resource configuration changes across all accounts
# - Required for compliance reporting (SOC 2, PCI-DSS, HIPAA)
# - Provides resource inventory and configuration history
# - Config rules evaluate compliance automatically
# - Cost: ~$0.003 per configuration item + $0.001 per rule evaluation
#
# AWS GuardDuty:
# - Continuous threat detection using machine learning
# - Monitors CloudTrail, VPC Flow Logs, DNS logs, S3 data events
# - Detects compromised instances, reconnaissance, unauthorized access
# - Auto-enables for new organization accounts
# - Cost: Starts at $4.60/month + usage-based pricing
#
# AWS Security Hub:
# - Centralized security posture management
# - Aggregates findings from GuardDuty, Config, Inspector, etc.
# - Provides security scores and compliance dashboards
# - CIS AWS Foundations Benchmark automated checks
# - Cost: ~$0.0010 per 10,000 findings ingested + $0.001 per check
#
# Recommended Deployment Order:
# 1. Enable AWS Config first (required for Security Hub compliance checks)
# 2. Enable GuardDuty (provides threat detection findings)
# 3. Enable Security Hub (aggregates findings from Config and GuardDuty)
#
# Email Notifications:
# - All SNS email subscriptions require manual confirmation
# - Check inbox for confirmation email after deployment
# - Click confirmation link to start receiving alerts
